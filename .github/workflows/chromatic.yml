name: Chromatic
on:
    workflow_call:
        inputs:
            pr_number:
                required: true
                type: number
            pr_sha:
                required: false
                type: string
                default: ''
jobs:
    # run_chromatic:
    #     name: Run Chromatic
    #     runs-on: ubuntu-latest
    #     steps:
    #         - name: Checkout code
    #           uses: actions/checkout@v4
    #           with:
    #               ref: ${{ inputs.pr_sha || github.sha }}
    #               fetch-depth: 0
    #         - name: Setup package manager
    #           uses: pnpm/action-setup@v3
    #           with:
    #               version: 10
    #               run_install: false
    #         - name: Setup node
    #           uses: actions/setup-node@v4
    #           with:
    #               node-version: 22.15.0
    #               cache: 'pnpm'
    #         - name: Install dependencies
    #           run: pnpm install --frozen-lockfile
    #         - name: Run Chromatic
    #           uses: chromaui/action@latest
    #           with:
    #               projectToken: ${{ secrets.CHROMATIC_PROJECT_TOKEN }}
    #               buildScriptName: 'build:storybook'
    #               onlyChanged: true
    #               zip: true
    post_result:
        name: Post results
        runs-on: ubuntu-latest
        # needs: run_chromatic
        permissions:
            pull-requests: write
        steps:
            - uses: actions/github-script@v7
              with:
                  script: |
                      github.rest.issues.createComment({
                        owner: context.repo.owner,
                        repo: context.repo.repo,
                        issue_number: ${{ inputs.pr_number }},
                        body: 'CHROMATIC EXECUTED'
                      })
